(function(t){function e(e){for(var i,o,a=e[0],c=e[1],l=e[2],d=0,f=[];d<a.length;d++)o=a[d],r[o]&&f.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(f.length)f.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},s=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var i=n("c21b"),r=n.n(i);r.a},"0cf6":function(t,e,n){"use strict";var i=n("117a"),r=n.n(i);r.a},"117a":function(t,e,n){},2315:function(t,e,n){"use strict";var i=n("32ed"),r=n.n(i);r.a},"32ed":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("card-container",{ref:"conCard",on:{setting:t.openSetting}}),n("setting-container",{directives:[{name:"show",rawName:"v-show",value:t.settingOpened,expression:"settingOpened"}],ref:"conSetting",on:{close:t.saveSetting}})],1)},s=[],o=(n("456d"),n("ac6a"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.fullscreen,expression:"!fullscreen"}],staticClass:"btn full",on:{click:t.enterFullScreen}},[t._v("")]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.fullscreen,expression:"fullscreen"}],staticClass:"btn full",on:{click:t.cancelFullScreen}},[t._v("")]),n("div",{staticClass:"btn star",class:{actived:t.stared},on:{click:t.toggleStar}},[t._v("")]),n("div",{staticClass:"btn remove",on:{click:t.ignoreWord}},[t._v("")]),n("div",{staticClass:"btn next",on:{click:t.nextWord}},[t._v("")]),n("div",{staticClass:"btn prev",on:{click:t.prevWord}},[t._v("")]),n("div",{staticClass:"btn setting",on:{click:t.showSetting}},[t._v("")]),n("div",{staticClass:"btn refresh",on:{click:t.getWord}},[t._v("")]),n("canvas",{ref:"cvsBoard",staticClass:"board"}),n("div",{staticClass:"index-indicator"},[t._v("\n        "+t._s(t.index+1)+" / "+t._s(t.total)+"\n    ")])])}),a=[],c=(n("6762"),n("2fdb"),{name:"card-container",data:function(){return{currentData:null,availWidth:0,availHeight:0,time:0,stared:!1,index:0,total:0,inited:!1,settings:{hotkeys:{prev:[],next:[],ignore:[],star:[]}},fullscreen:!1,isFocus:!1}},methods:{updateSettings:function(t){var e=this;this.inited||this.init(),Object.keys(t.hotkeys).forEach(function(n){e.updateKeysArray(n,t.hotkeys[n])}),this.isFocus=!0},updateKeysArray:function(t,e){var n=this;this.settings.hotkeys[t].length=0,e.forEach(function(e){n.settings.hotkeys[t].push(e)})},init:function(){var t=this;this.clock(),this.getWord(),window.addEventListener("keydown",function(e){var n=!1;if(t.isFocus&&(console.log(e.keyCode),console.log(t.settings.hotkeys.next),console.log(t.settings.hotkeys.next.includes(e.keyCode)),t.settings.hotkeys.next.includes(e.keyCode)?(n=!0,t.nextWord()):t.settings.hotkeys.prev.includes(e.keyCode)?(n=!0,t.prevWord()):t.settings.hotkeys.ignore.includes(e.keyCode)?(n=!0,t.ignoreWord()):t.settings.hotkeys.star.includes(e.keyCode)&&(n=!0,t.toggleStar())),n)return e.preventDefault(),e.stopPropagation(),!1}),this.inited=!0},clock:function(){var t=window.innerWidth-72,e=window.innerHeight-72;t===this.availWidth&&e===this.availHeight||this.resize(t,e),setTimeout(this.clock,100)},resize:function(t,e){var n=this.$refs.cvsBoard;window.devicePixelRatio&&window.devicePixelRatio>1?(n.width=parseInt(t*window.devicePixelRatio),n.height=parseInt(e*window.devicePixelRatio)):(n.width=t,n.height=e),n.style.width=t+"px",n.style.height=e+"px",this.availWidth=t,this.availHeight=e,this.currentData&&this.renderCard()},enterFullScreen:function(){var t=this.$el;t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullScreen&&t.msRequestFullScreen(),this.fullscreen=!0},cancelFullScreen:function(){document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.mskitCancelFullScreen&&document.msCancelFullScreen(),this.fullscreen=!1},toggleStar:function(){this.stared?this.unstarWord():this.starWord()},showSetting:function(){this.isFocus=!1,this.$emit("setting")},getWord:function(){var t=this;this.$api("word",function(e){e&&t.renderCard(e)},function(t,e){alert(e)})},nextWord:function(){var t=this;this.$api("next",function(e){e&&t.renderCard(e)})},prevWord:function(){var t=this;this.$api("prev",function(e){e&&t.renderCard(e)})},starWord:function(){var t=this;this.$api("star",function(){t.getWord()})},unstarWord:function(){var t=this;this.$api("unstar",function(){t.getWord()})},ignoreWord:function(){var t=this;this.$api("ignore",function(){t.getWord()})},renderCard:function(t){var e=this.$refs.cvsBoard,n=e.getContext("2d");t?this.currentData=t:t=this.currentData,this.index=t.index,this.total=t.total,this.stared=1===t.progress.star;var i=e.width,r=e.height,s=parseInt(r/16),o=t.card.word,a=t.card.translation,c=t.card.phonetic&&t.card.phonetic.length>0?"/ "+t.card.phonetic+" /":"-",l=t.card.context;n.clearRect(0,0,i,r),n.textAlign="start",n.textBaseline="middle",n.fillStyle="#25b8c1",n.font=n.getPropertySingleLineFont(o,parseInt(r/8)),n.fillText(o,0,r/16),s+=parseInt(r/8),n.fillStyle="#61839f",n.font=n.getPropertySingleLineFont(c,parseInt(r/12)),n.fillText(c,0,s),s+=parseInt(r/8),n.fillStyle="#ffffff",n.font=n.getPropertySingleLineFont(a,parseInt(r/12)),n.fillText(a,0,s),s+=parseInt(r/8),n.fillStyle="#61839f",n.font=n.getPropertyMultiLineFont(l,e.width,parseInt(5*e.height/8),parseInt(r/12)),n.fillTextLines(n.getTextLines(t.card.context),0,s)}}}),l=c,u=(n("0cf6"),n("2877")),d=Object(u["a"])(l,o,a,!1,null,"37d586d1",null);d.options.__file="CardContainer.vue";var f=d.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"setting-container",attrs:{id:"setting-container"}},[n("div",{staticClass:"hd"},[t._v("设置")]),n("div",{staticClass:"btn close",on:{click:t.close}},[t._v("")]),n("div",{staticClass:"setting-area"},[t._m(0),t._l(t.settings.hotkeys,function(e,i){return n("div",{staticClass:"row"},[n("div",{staticClass:"hot-key-type"},[t._v("\n                "+t._s(t.getKeyLang(i))+"\n            ")]),t._l(e,function(e,r){return n("div",{staticClass:"hot-key-item"},[n("div",{staticClass:"key"},[t._v("\n                    "+t._s(t.getNameByKeyCode(e))+"\n                ")]),n("div",{staticClass:"remove",on:{click:function(e){t.removeKey(i,r)}}},[t._v("\n                    \n                ")])])}),n("div",{staticClass:"add-key-btn",on:{click:function(e){t.addKey(i)}}},[t._v("")])],2)})],2),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isWaitingInput,expression:"isWaitingInput"}],staticClass:"mask"},[n("div",{staticClass:"tips"},[t._v("请按下按键")])])])},p=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("div",{staticClass:"group"},[t._v("\n                快捷键\n            ")])])}],v={name:"setting-container",data:function(){return{settings:{hotkeys:{prev:[],next:[],ignore:[],star:[]}},isWaitingInput:!1}},methods:{updateSettings:function(t){var e=this;Object.keys(t.hotkeys).forEach(function(n){e.updateKeysArray(n,t.hotkeys[n])})},updateKeysArray:function(t,e){var n=this;this.settings.hotkeys[t].length=0,e.forEach(function(e){n.settings.hotkeys[t].push(e)})},getKeyLang:function(t){var e={prev:"前进",next:"后退",ignore:"忽略",star:"收藏"};return e[t]},getNameByKeyCode:function(t){var e={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause_break",20:"caps_lock",27:"escape",33:"page_up",34:"page_down",35:"end",36:"home",37:"left_arrow",38:"up_arrow",39:"right_arrow",40:"down_arrow",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"left_win",92:"right_win",93:"select",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"multiply",107:"add",109:"subtract",110:"decimal_point",111:"divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"num_lock",145:"scroll_lock",186:"semi_colon",187:"equal_sign",188:"comma",189:"dash",190:"period",191:"forward_slash",192:"grave_accent",219:"open_bracket",220:"back_slash",221:"close_braket",222:"single_quote"};return t in e?e[t]:"#"+t},removeKey:function(t,e){this.settings.hotkeys[t].splice(e,1)},addKey:function(t){var e=this,n=function n(i){return e.settings.hotkeys[t].includes(i.keyCode)||e.settings.hotkeys[t].push(i.keyCode),window.removeEventListener("keydown",n),e.isWaitingInput=!1,i.preventDefault(),i.stopPropagation(),!1};this.isWaitingInput=!0,window.addEventListener("keydown",n)},getSettings:function(){return JSON.parse(JSON.stringify(this.settings))},close:function(){this.$emit("close",this.getSettings())}}},g=v,y=(n("2315"),Object(u["a"])(g,h,p,!1,null,"358185bf",null));y.options.__file="SettingContainer.vue";var m=y.exports,w={name:"app",components:{CardContainer:f,SettingContainer:m},data:function(){return{settingOpened:!1}},mounted:function(){var t=this;this.$api("settings",function(e){t.$refs.conCard.updateSettings(e),t.$refs.conSetting.updateSettings(e)})},methods:{openSetting:function(){this.settingOpened=!0},saveSetting:function(t){var e=this;this.settingOpened=!1,Object.keys(t.hotkeys).forEach(function(n){e.$api("setkey",{key:n,val:t.hotkeys[n].join(",")})}),this.$refs.conCard.updateSettings(t)}}},_=w,k=(n("034f"),Object(u["a"])(_,r,s,!1,null,null,null));k.options.__file="App.vue";var x=k.exports,C=(n("f751"),function(t,e){function n(t,e,n,s){var o,a,c,l;l=i,4==arguments.length?(o=t,a=e,c=n,l=s):3==arguments.length?(o=t,"function"==typeof e?(c=e,l=n):(a=e,c=n)):2==arguments.length?(o=t,"function"==typeof e?c=e:a=e):o=t,a=a||{};var u=new XMLHttpRequest;u.handleerror=function(t){t?"string"==typeof t?l&&l(1002,"Server returns unexpected."):void 0!==t.errcode?l&&l(t.errcode,t.errmessage):l&&l(1003,"Unexpected error(2)."):l&&l(1001,"Unexpected error(1).")},u.onreadystatechange=function(){var t;if(4==this.readyState){if(200!=this.status)return this.handleerror();t=this.responseText;try{t=JSON.parse(t)}catch(e){return this.handleerror(t)}if(!("errcode"in t&&0===t.errcode))return this.handleerror(t);c&&c(t.data)}},u.open("POST","api/"+o,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(r(a))}function i(t,e){alert(e)}function r(t){var e,n=[];for(e in t)n.push(e+"="+encodeURIComponent(t[e]));return n.join("&")}Object.defineProperties(e.prototype,{$api:{get:function(){return n}}}),Object.defineProperties(t,{api:{get:function(){return n}}})}),b=function(t,e){CanvasRenderingContext2D.prototype.getPropertySingleLineFont=function(t,e,n,i){i=i||"Arial",e=e||40,n=n||12;var r=this.font,s=e;this.font=s+"px "+i;var o=this.measureText(t);while(o.width>this.canvas.width){if(s-=1,s<n)return this.font=r,n+"px "+i;this.font=s+"px "+i,o=this.measureText(t)}return this.font=r,s+"px "+i},CanvasRenderingContext2D.prototype.getPropertyMultiLineFont=function(t,e,n,i,r,s){s=s||"Arial",i=i||40,r=r||12;var o=this.font,a=i,c=parseInt(1.5*a);this.font=a+"px "+s;var l=this.getTextLines(t,e);while(l.length*c>n){if(a--,a<r)return this.font=o,r+"px "+s;c=parseInt(1.5*a),l=this.getTextLines(t,e)}return this.font=o,a+"px "+s},CanvasRenderingContext2D.prototype.getTextLines=function(t,e){e=e||this.canvas.width;var n,i,r,s=[];while(t.length){for(n=t.length;this.measureText(t.substr(0,n)).width>e;n--);if(r=t.substr(0,n),n!==t.length)for(i=0;-1!==r.indexOf(" ",i);i=r.indexOf(" ",i)+1);s.push(r.substr(0,i||r.length)),t=t.substr(s[s.length-1].length,t.length)}return s},CanvasRenderingContext2D.prototype.fillTextLines=function(t,e,n,i){var r;for(i=i||parseInt(1.5*parseInt(this.font)),r=0;r<t.length;r++)this.fillText(t[r],e,n+r*i)}},S={},F=Object.assign(S,{install:function(t,e){C(S,t),b(S,t),window.injection=S}});i["a"].config.productionTip=!1,i["a"].use(F),F.Vue=new i["a"]({render:function(t){return t(x)}}).$mount("#app")},c21b:function(t,e,n){}});
//# sourceMappingURL=app.4b186de5.js.map